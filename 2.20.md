#### Question 1 å‡è®¾æ£€éªŒ

##### æ•°æ®é¢„å¤„ç†

###### åˆ›å»ºåˆ†ç±»å˜é‡

ä¸ºæœˆæ”¶å…¥åˆ›å»ºä¸€ä¸ªè¿ç»­å˜é‡ï¼Œä¸ºæ”¶å…¥ç»„åˆ›å»ºä¸€ä¸ªåˆ†ç±»å˜é‡ï¼ˆ0 = ä½ï¼Œ1 = ä¸­ç­‰ï¼Œ2 = é«˜ï¼‰ï¼Œä»¥åŠä¸ºæ‹¥æœ‰å¤§å­¦å­¦ä½çš„äººåˆ›å»ºä¸€ä¸ªåˆ†ç±»å˜é‡ï¼ˆ0 = éå­¦ä½æŒæœ‰è€…ï¼Œ1 =å­¦ä½æŒæœ‰è€…ï¼‰ã€‚

https://www.slideshare.net/TRIPACCK/stata-tutorial p34

Use recode command: 

è½¬æ¢è¿ç»­å˜é‡ä¸ºåˆ†ç±»å˜é‡: 10\~100æ ‡è®°ä¸º0ï¼Œ101~1000æ ‡è®°ä¸º1,....

```
recode incmonth (10/100=0) (101/1000=1) (1000/5000=2), generate(incmonth_cat)
```

æŸ¥çœ‹æ–°åˆ›å»ºçš„å˜é‡ï¼Œå„ä¸ªåˆ†ç±»çš„å æ¯”å’Œé¢‘æ•°

```
tabulate incmonth_cat
```

æˆ–è€…

```
tab incmonth_cat
```

###For reference only ğŸ‘‡###

å¦‚æœéœ€è¦æŠŠå­—ç¬¦ä¸²è½¬ä¸ºåˆ†ç±»å˜é‡ï¼šå‡è®¾å­—æ®µcollege'ä¸Šè¿‡å¤§å­¦'ï¼Œ'æ²¡ä¸Šè¿‡å¤§å­¦'åˆ†åˆ«ç”¨æ•°å­—è¡¨ç¤ºã€‚æ¯”å¦‚0,1

```
encode college, gen(college_cat)
describe college_cat
```

æ­¤æ—¶æ˜¾ç¤ºçš„æ•°æ®ä»ç„¶æ˜¯å­—ç¬¦ï¼Œä½†æ˜¯æ–°å˜é‡college_catç±»å‹å·²ç»ä¸ºåˆ†ç±»å˜é‡äº†ã€‚college ç±»å‹ä¸ºstr, college_catç±»å‹ä¸ºlongã€‚å¯ä»¥ç”¨ä¸‹é¢æŒ‡ä»¤ï¼Œçœ‹åˆ°college_catå·²ç»è¢«æ ‡ä¸ºæ•°å­—ã€‚

```
list college_cat, nolab
```

æŠŠæœ€ç»ˆçš„college_catç”¨labelæ ‡è®°ä¸Š0ï¼Œ1ï¼Œ2ï¼Œ3.ä¿å­˜ä¸ºcollege_cat_labelå­—æ®µã€‚

```
label define college_cat_label 1 'ä¸Šè¿‡å¤§å­¦' 0 'æ²¡ä¸Šå¤§å­¦'
```

æ­¤æ—¶ï¼Œcollege_catå¯ä»¥ä¸ç”¨ç•™ä¸‹äº†ï¼Œcollege_cat_labelæ˜¯æˆ‘ä»¬æœ€åå¾—åˆ°çš„ï¼ŒåªåŒ…å«0,1çš„å­—æ®µã€‚åˆ©ç”¨dropå¯ä»¥åˆ é™¤college_catå­—æ®µã€‚

```
drop college_cat
```

*æˆ–è€…ä½¿ç”¨replace

###### åˆ é™¤æœ‰ç©ºå€¼çš„è®°å½•

å»æ‰colåˆ—æœ‰ç¼ºå¤±çš„è®°å½•ï¼š

```
egen miss_col=rowmiss(col)
drop if miss_col>0
```

åˆ é™¤å¸¦æœ‰å­—ç¬¦çš„è®°å½•ï¼š

```
drop if col == ""
keep if col > 0
```

https://www.reed.edu/data-at-reed/resources/Stata/missing-values.html

###### Refs

- *å¯¹äºè¿ç»­å˜é‡è½¬åˆ†ç±»å˜é‡*
  - :star:Usage of recode:https://www.stata.com/manuals13/drecode.pdf
  - ä¸€ä¸ªç¤ºä¾‹ï¼šhttps://youtu.be/2mzeIh2kwsk

- *å¯¹äºå­—ç¬¦è½¬ä¸ºåˆ†ç±»å˜é‡*
  - Working with Stringsï¼šhttps://www.stata.com/manuals13/u23.pdf
  - :star:æ¨èï¼šhttps://www.youtube.com/watch?v=QN7u-ZBHqic

##### a) æ€»ä½“å‡å€¼çš„æ£€éªŒ (å•ç»„æ ·æœ¬) 

æœ‰äººå‘Šè¯‰ä½ ï¼Œ2003å¹´ä¸­å›½äººå£çš„å¹³å‡æœˆæ”¶å…¥æ˜¯1000å…ƒã€‚é€šè¿‡ 5% æ°´å¹³çš„ç»Ÿè®¡æµ‹è¯•éªŒè¯æ­¤å£°æ˜ï¼ˆè®¾ç½® Î±=0.05ï¼‰ã€‚å±•ç¤ºæµ‹è¯•ç»“æœå’Œç»“è®ºã€‚

###### å•æ ·æœ¬å‡è®¾æ£€éªŒ

åˆ©ç”¨å•æ ·æœ¬å‡è®¾æ£€éªŒï¼ŒéªŒè¯æœˆæ”¶å…¥å¹³å‡å€¼æ˜¯ä¸æ˜¯1000

```
ttest incmonth == 1000
```

###### Refs:

https://youtu.be/HwzCyqW-0dc

##### b) ä¸¤ä¸ªæ€»ä½“çš„æ£€éªŒ ï¼ˆä¸¤ç»„æ ·æœ¬ï¼‰

åœ¨ 5% çš„æ°´å¹³ä¸Šæ£€éªŒå­¦ä½æŒæœ‰è€…å’Œéå­¦ä½æŒæœ‰è€…ä¹‹é—´çš„æœˆæ”¶å…¥æ˜¯å¦ç›¸ç­‰ï¼ˆè®¾ç½® Î±=0.05ï¼‰ã€‚æ ¹æ®Stataç»“æœï¼Œè®¨è®ºé«˜ç­‰æ•™è‚²æ˜¯å¦ä¼šå¸¦æ¥æ›´é«˜çš„æ”¶å…¥ã€‚å±•ç¤ºæµ‹è¯•ç»“æœå’Œç»“è®ºã€‚

###### åŒæ ·æœ¬å‡è®¾æ£€éªŒ

è¿™é‡Œçš„'å­¦ä½'æŒ‡è¡¨ç¤ºæ˜¯å¦æ‹¥æœ‰å­¦ä½çš„å­—æ®µå˜é‡ï¼Œä¹Ÿè®¸æ˜¯educ

æ‰§è¡Œå‰æ£€æŸ¥ä¸‹æ•°æ®æ˜¯å¦åªæœ‰ä¸¤ä¸ªå˜é‡

```
ttest incmonth, by(å­¦ä½)
```

###### Refs: 

- æ“ä½œæ–¹æ³•1ï¼šhttps://youtu.be/5RUV7d6mcfU

- :star:æ“ä½œæ–¹æ³•2+è§£é‡Šç»“æœï¼ˆ**æ¨è**ï¼‰ï¼šhttps://www.youtube.com/watch?v=7kJKoDcb1Is

##### c) ç¦»æ•£å˜é‡ä¹‹é—´çš„æ£€éªŒ

åœ¨ 5% çš„æ°´å¹³ä¸Šæ£€éªŒ**æ”¶å…¥ç»„**(incmonth_cat)ä¸**å­¦ä½æŒæœ‰è€…**(educ_cat, 1è¡¨ç¤ºæœ‰å­¦ä½ï¼Œ0è¡¨ç¤ºæ— å­¦ä½)ä¹‹é—´çš„å…³ç³»ï¼ˆè®¾ç½® Î±=0.05ï¼‰ã€‚æ ¹æ®Stataç»“æœï¼Œè®¨è®ºé«˜ç­‰æ•™è‚²æ˜¯å¦ä¸æ”¶å…¥ç¾¤ä½“æœ‰å…³è”ã€‚å±•ç¤ºæµ‹è¯•ç»“æœå’Œç»“è®ºã€‚

```
tabulate incmonth_cat edu_cat, cchi2 cell chi2 column exact expected lrchi2 row v
```

é€—å·åé¢çš„å‚æ•°ï¼Œæ˜¯æˆ‘ä»¬æƒ³è¦æ˜¾ç¤ºã€è®¡ç®—çš„ç»Ÿè®¡å€¼ï¼Œå†™åœ¨é€—å·åé¢ï¼Œtabulateå‡½æ•°ä¼šæŒ‰è¦æ±‚è¿”å›ç»“æœï¼š

cchi: contribution to chi-square

chi2: æ˜¾ç¤ºçš®å°”æ£®å¡æ–¹åˆ†å¸ƒæŒ‡æ ‡

cell: æ¯ä¸ªå˜é‡çš„è´¡çŒ®

...

ç»“æœä¸­Prï¼ŒPearson chi2æ˜¯æˆ‘ä»¬å…³æ³¨çš„æ•°å€¼ï¼Œå†³å®šäº†å…³è”æ˜¯å¦æ˜¾è‘—(significant)ã€‚

###### Example

| æ”¶å…¥ç»„\\\\å­¦ä½æŒæœ‰æƒ…å†µ | 0ï¼ˆæ— å­¦ä½ï¼‰ | 1ï¼ˆæœ‰å­¦ä½ï¼‰ |
| :--------------------: | :---------: | :---------: |
|      0ï¼ˆä½æ”¶å…¥ï¼‰       |     100     |     10      |
|      1ï¼ˆä¸­æ”¶å…¥ï¼‰       |     50      |     50      |
|      2ï¼ˆé«˜æ”¶å…¥ï¼‰       |     40      |     100     |

###### Refs:

- å¦‚ä½•æ ¹æ®æ•°æ®é€‰æ‹©æ£€éªŒçš„æ–¹æ³•ï¼šhttps://blog.csdn.net/huangguohui_123/article/details/103841656 

- Stataå¤„ç†ç¦»æ•£å˜é‡çš„å…³è”å…³ç³»ä¸æ£€éªŒæ–¹æ³•ä»‹ç»ï¼šhttps://www3.nd.edu/~rwilliam/stats1/Categorical-Stata.pdf

- :star:å…·ä½“æ“ä½œä¸ç»“æœè§£é‡Š(**æ¨è**)ï¼šhttps://youtu.be/KRXzawDnoKo

- è§£é‡Šç»“æœï¼šhttp://www.stat.yale.edu/Courses/1997-98/101/chisq.htm

- Extensions:
  - https://stats.oarc.ucla.edu/stata/modules/a-statistical-sampler-in-stata/
  - https://people.umass.edu/biep640w/pdf/Stata%20for%20Discrete%20Distributions%20and%20Fisher%20Exact%20Test.pdf

#### Question 2 å¤šå…ƒçº¿æ€§å›å½’

##### å¤šå…ƒçº¿æ€§å›å½’

```
reg y x1 x2 x3 
```

è§£é‡Šç»“æœï¼šhttps://www.bilibili.com/video/BV1U54y1R7iL/?spm_id_from=autoNext

:star:https://stats.oarc.ucla.edu/stata/output/regression-analysis/

##### æè¿°å˜é‡

åˆ›å»ºä½ éœ€è¦çš„å˜é‡ã€‚åœ¨è¡¨æ ¼ä¸­æ±‡æ€»æè¿°æ€§ç»Ÿè®¡æ•°æ®ï¼ˆå¹³å‡å€¼/ç™¾åˆ†æ¯”ã€æ ‡å‡†å·®ç­‰ï¼‰ã€‚

```
tabstat x1 x2 x3 x4, s(mean, median, sd, var, count, range, min, max)
```

##### æ§åˆ¶å˜é‡

æ•™è‚²çš„ç»æµå›æŠ¥æ˜¯å¤šå°‘: å¯ä»¥è°ƒæ•´å­¦ä½å­—æ®µï¼Œ0ä¸ºæ²¡å­¦ä½ï¼Œ1è¡¨ç¤ºæœ‰å­¦ä½ã€‚

ç”·å¥³çš„å·®å¼‚æ˜¯å¤šå°‘ï¼šè°ƒæ•´sexå­—æ®µï¼Œ0ä¸ºç”·ï¼Œ1ä¸ºå¥³

```
reg y x1 x2 i.x3
```

sexå­—æ®µçš„å€¼æ²¡æœ‰å®é™…æ„ä¹‰ï¼Œä½¿ç”¨dummy variableæ›´è´´åˆå®é™…ã€‚

æŸ¥çœ‹coef. å‚æ•°ä¸ºçº¿æ€§å›å½’çš„å˜é‡æƒé‡ã€‚

æ“ä½œä¸è§£é‡Šï¼ˆè§†é¢‘ï¼‰ï¼š:star:https://www.bilibili.com/video/BV1nT4y1571o?share_source=copy_web

##### æŸ¥çœ‹å˜é‡ä¹‹é—´çš„å…³è”

```
pwcorr y x1 x2 x3
```

åŒæ—¶æ˜¾ç¤ºå…³è”æ˜¯å¦æ˜¾è‘—ï¼š

```
pwcorr y x1 x2 x3, sig
```

æ˜¾ç¤ºå‡ºçš®å°”æ£®ç³»æ•°å’ŒP-value

e.g.

```
pwcorr incmonth sex, sig
```

###### Refs

æ“ä½œä¸è§£é‡Šï¼šhttps://statistics.laerd.com/stata-tutorials/multiple-regression-using-stata.php

##### å¦‚ä½•è®©çº¿æ€§å›å½’çš„æ•ˆæœæ›´å¥½â€”â€”ä¼˜åŒ–æ¨¡å‹

###### å»é™¤æ–¹å·®Robust Linear Regression

```
reg y x1 x2 x3, r
```

#### å…¶ä»–Stataæ“ä½œèµ„æ–™

Tutorials å¯ä»¥å¤§è‡´æŸ¥çœ‹Stataçš„å¤§è‡´æŒ‡ä»¤

- Tutorial1: https://www.slideshare.net/TRIPACCK/stata-tutorial

- Tutorial2: https://www.slideshare.net/izahn/intro-to-stata-slides

å®˜æ–¹æ–‡æ¡£å’Œcheat sheet å¯ä»¥ä½œä¸ºå·¥å…·ä¹¦æŸ¥æ‰¾å‡½æ•°ç”¨æ³•

- å®˜æ–¹æ–‡æ¡£
  -  https://www.stata.com/features/overview/quick-starts/
  -  https://www.stata.com/manuals/r.pdf
  -  å¤šå…ƒçº¿æ€§å›å½’åˆ†æï¼šhttps://www.stata.com/manuals/erm.pdf

- Stata cheat sheet

  https://www.stata.com/bookstore/statacheatsheets.pdf

